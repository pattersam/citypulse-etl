tasks:
  # terminal for running citypulse-etl
  - name: python
  - init: python -m virtualenv venv
    command: |
      source venv/bin/activate
      pip install -r requirements.txt

  # termainal for building docs & autogenerated diagrams
  - name: build docs
  - init: |
      sudo apt-get update -y
      sudo apt-get install -y pandoc
      sudo apt-get install -y texlive-latex-base texlive-fonts-recommended texlive-fonts-extra texlive-latex-extra texlive-xetex librsvg2-bin texlive-science
      npm install --global mermaid-filter
      npm install -g sqleton
      sudo apt-get install -y graphviz
      pip install pydeps
    command: cd docs
    openMode: split-right

  # serve docs directory for in-browser preview
  - name: serve docs
    command: python -m http.server -d docs

ports:
  # docs
  - port: 8000
    onOpen: open-browser
